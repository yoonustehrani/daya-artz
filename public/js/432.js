"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[432],{5401:(t,e,n)=>{n.d(e,{s:()=>r,m:()=>o});var r={templateResult:function(t){if(!t.id)return t.text;var e="".concat(APP_PATH,"images/world-icons/");return $('<span class="span-option"><img src='.concat(e+t.id.toLowerCase()+".svg",' class="img-flag"/>').concat(t.text,"</span>"))},width:"100%",dir:"rtl",dropdownAutoWidth:!0},o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{width:"100%",dir:"rtl",placeholder:t}}},7292:(t,e,n)=>{n.d(e,{Z:()=>i});var r=n(645),o=n(5893);function i(t){var e=t.size,n=void 0===e?34:e;return(0,o.jsx)("div",{className:"activity-container",children:(0,o.jsx)(r.Spinner,{color:"#6332df",size:n})})}},432:(t,e,n)=>{n.r(e),n.d(e,{default:()=>S});var r=n(7757),o=n.n(r),i=n(7294),a=n(5401),c=n(2624),s=n(3733),l=n(7292),u=n(5893);function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,c=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){c=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function m(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){m(i,r,o,a,c,"next",t)}function c(t){m(i,r,o,a,c,"throw",t)}a(void 0)}))}}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e){return g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},g(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=w(t);if(e){var o=w(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return j(this,n)}}function j(t,e){if(e&&("object"===p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return x(t)}function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}function k(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}(p,t);var e,n,r,i=b(p);function p(){var t;y(this,p);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return k(x(t=i.call.apply(i,[this].concat(n))),"state",{departments:[],loading:!0,files:[],department:"",title:"",ticket_content:""}),k(x(t),"sendNewTicket",h(o().mark((function e(){var n,r,i,a,c,s,l,u,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,r=n.title,i=n.department,a=n.ticket_content,c=n.files,s=new FormData,Object.entries({title:r,department:i,ticket_content:a}).map((function(t){var e=f(t,2),n=e[0],r=e[1];s.append(n,r)})),c.map((function(t){s.append("files[]",t)})),console.log(),e.next=7,t.http.post("",s,{headers:{"Content-Type":"multipart/form-data"}});case 7:l=e.sent,u=l.okay,p=l.ticket,u&&t.props.history.push("/tickets/".concat(p.id));case 10:case"end":return e.stop()}}),e)})))),k(x(t),"onFileSelect",(function(e){var n=[],r=0,o=!0,i=t.state.files;Array.prototype.push.apply(n,e.target.files);var a=/image\/\bjpg\b|\bpng\b|\bjpeg\b/;i&&(n=i.concat(n));for(var c=0;c<n.length;c++){var s=n[c];if(r+=s.size,!(o=a.test(s.type))){t.Alert.error({title:"فرمت فایل",text:"فقط فرمت های jpg, jpeg و png قابل قبول هستند."});break}}o&&(n.length>3?t.Alert.error({title:"تعداد فایل",text:"حد اکثر تعداد فایل های انتخابی 3 عدد می باشد."}):r>12582912?t.Alert.error({title:"حجم فایل های انتخابی",text:"حد اکثر حجم فایل های انتخابی 12 مگابایت می باشد."}):t.setState({files:n},(function(){$("#image-input").val("")})))})),k(x(t),"deleteFile",(function(e){var n=t.state.files;n.splice(e,1),t.setState({files:n})})),k(x(t),"changeDepartment",(function(e){t.setState({department:e})})),k(x(t),"loadDepartments",h(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.http.get("/departments");case 2:(n=e.sent)[0]&&t.setState({loading:!1,departments:n},(function(){$("#department-section").select2((0,a.m)("بخش مربوطه")),$("#department-section").on("select2:select",(function(){t.changeDepartment($("#department-section").val())}))}));case 4:case"end":return e.stop()}}),e)})))),t}return e=p,(n=[{key:"componentDidMount",value:function(){document.title="ارسال تیکت جدید",this.http=(0,s.k)("/userarea/tickets"),this.Alert=new c.Z({showConfirmButton:!0,confirmButtonText:"بستن",customClass:{container:"rtl"}}),this.loadDepartments()}},{key:"render",value:function(){var t=this,e=this.state,n=e.files,r=e.departments,o=e.loading;return(0,u.jsx)("div",{className:"new-ticket-container",children:o?(0,u.jsx)(l.Z,{}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"input-group",children:(0,u.jsxs)("select",{id:"department-section",children:[(0,u.jsx)("option",{}),r.length>0&&r.map((function(t){return(0,u.jsx)("option",{value:t.id,children:t.name},t.id)}))]})}),(0,u.jsx)("div",{className:"input-group my-2",children:(0,u.jsx)("input",{className:"form-control",onChange:function(e){return t.setState({title:e.target.value})},placeholder:"عنوان تیکت"})}),(0,u.jsxs)("div",{className:"msg-text-section",children:[(0,u.jsx)("div",{className:"input-group",children:(0,u.jsx)("textarea",{className:"form-control",onChange:function(e){return t.setState({ticket_content:e.target.value})},placeholder:"متن تیکت"})}),(0,u.jsx)("button",{className:"btn btn-lg btn-light",onClick:this.sendNewTicket,children:"ارسال تیکت"})]}),(0,u.jsxs)("div",{className:"upload-boxes",children:[(0,u.jsx)("div",{className:"files-preview",children:n&&n.length>0?n.map((function(e,n){return(0,u.jsxs)("div",{className:"selected-image",children:[(0,u.jsx)("img",{src:URL.createObjectURL(e)}),(0,u.jsx)("a",{className:"badge badge-pill badge-dark",onClick:t.deleteFile.bind(t,n),children:(0,u.jsx)("i",{className:"far fa-trash-alt"})})]},n)})):"فایل های ضمیمه شما در این قسمت نمایش داده می شود"}),(0,u.jsxs)("div",{className:"choose-file",children:[(0,u.jsx)("h4",{children:"افزودن عکس"}),(0,u.jsx)("span",{children:"[jpg, jpeg, png]"}),(0,u.jsx)("input",{className:"d-none",type:"file",name:"image-input",id:"image-input",onChange:this.onFileSelect,accept:".png,.jpg,.jpeg",multiple:!0}),(0,u.jsx)("label",{className:"btn btn-light btn-sm",htmlFor:"image-input",children:"انتخاب"})]})]})]})})}}])&&v(e.prototype,n),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),p}(i.Component)}}]);