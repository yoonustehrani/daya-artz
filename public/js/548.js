"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[548],{9756:(e,t,r)=>{function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.d(t,{vM:()=>a,Z:()=>c,Iu:()=>o,AZ:()=>l});var a=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;s(this,e),this.targetObj=JSON.parse(JSON.stringify(t)),this.value=n;var i=r.split(".");i.length>1?(this.lastKey=i.pop(),this.lastObj=i.reduce((function(e,t){return e[t]=e[t]&&!Array.isArray(e[t])?e[t]:{}}),this.targetObj)):(this.lastObj=this.targetObj,this.lastKey=r)}var t,r,n;return t=e,(r=[{key:"make",value:function(){return this.lastObj[this.lastKey]=this.value,this.targetObj}},{key:"get",value:function(){var e;return null!==(e=this.lastObj[this.lastKey])&&void 0!==e?e:""}}])&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e){return!Object.keys(e).length}var o=function(e){var t;return(n(t={automate:"اتومات",manual:"دستی","just-recieved":"دریافت شده","in-progress":"در حال انجام",finished:"تمام شده",submitted:"دریافت سفارش",reviewed:"بررسی جزئیات",designing:"در دست طراحی",ready:"آماده تحویل",editing:"در حال ویرایش",canceled:"لغو شده",suspended:"تعلیق شده"},"finished","اتمام سفارش"),n(t,"checked-out","تسویه و تحویل"),t)[e]},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"".concat(Number(e).toLocaleString("en-US")).concat(t?" تومان":"")}},5155:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(645),s=r(5893);function i(e){var t,r;return(0,s.jsx)("div",{className:"activity-container mb-2",children:(0,s.jsx)(n.Spinner,{color:null!==(t=e.color)&&void 0!==t?t:"#999999",size:null!==(r=e.size)&&void 0!==r?r:34,speed:.5,animating:!0})})}},1548:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g});var n=r(7757),s=r.n(n),i=r(7294),a=r(5155),c=r(4181),o=r(3727),l=r(9756),d=r(5893);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function h(e,t,r,n,s,i,a){try{var c=e[i](a),o=c.value}catch(e){return void r(e)}c.done?t(o):Promise.resolve(o).then(n,s)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var i=e.apply(t,r);function a(e){h(i,n,s,a,c,"next",e)}function c(e){h(i,n,s,a,c,"throw",e)}a(void 0)}))}}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b(e);if(t){var s=b(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return x(e)}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(u,e);var t,r,n,i=j(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),y(x(t=i.call(this,e)),"loadTickets",f(s().mark((function e(){var r,n,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props.params.itemId,e.next=3,t.http.get("/items/".concat(r,"/tickets"));case 3:n=e.sent,i=n.tickets,t.setState({tickets:null!=i?i:[]});case 6:case"end":return e.stop()}}),e)})))),y(x(t),"onTicketClick",(function(e){return t.props.history.push("/tickets/".concat(e))})),y(x(t),"loadItem",f(s().mark((function e(){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props.params.itemId,e.next=3,t.http.get("/items/".concat(r));case 3:n=e.sent,t.loadTickets(),t.setState({orderItem:n,loading:!1},(function(){!n.item.canceled&&t.getLevel()}));case 6:case"end":return e.stop()}}),e)})))),y(x(t),"getLevel",(function(){var e,r=t.state.orderItem,n=r.item,s=r.statuses,i=n.status,a=s.normal,c=s.list;if(-1===a.indexOf(i))for(var o=c.slice(0,c.indexOf(i)).reverse(),l=0;l<o.length;l++){var d=o[l];if(a.includes(d)){e=a.indexOf(d)+1;break}}else e=a.indexOf(i)+1;t.setState({level:e})})),y(x(t),"getPercent",(function(e){var r=t.state,n=r.level*(100/r.orderItem.statuses.normal.length);return e?n:Math.floor(n)})),t.state={orderItem:null,level:null,loading:!0,tickets:[]},t}return t=u,(r=[{key:"componentDidMount",value:function(){var e=this.props.params.orderId;this.http=(0,c.k)("/userarea/orders/".concat(e)),this.loadItem()}},{key:"render",value:function(){var e=this,t=this.state,r=t.loading,n=t.orderItem,s=t.level,i=null!=n?n:{},u=i.item,h=(i.okay,i.order),f=i.statuses;return(0,d.jsx)("div",{children:r?(0,d.jsx)(a.Z,{}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"order-item-header",children:[(0,d.jsx)("div",{className:"order-item-header-title",children:(0,d.jsx)("h4",{children:u.title})}),(0,d.jsx)("div",{className:"progress",children:(0,d.jsx)("div",{className:"progress-bar ".concat(u.canceled&&"canceled"),style:{width:"".concat(this.getPercent(!0),"%")},role:"progressbar","aria-valuenow":u.canceled?"0%":"".concat(this.getPercent(!0),"%"),"aria-valuemin":"0%","area-valuemax":"100%",children:u.canceled?(0,d.jsxs)("span",{className:"text-danger",children:["لغو شده ",(0,d.jsx)("i",{className:"far fa-times"})]}):"".concat(this.getPercent(),"%")})})]}),(0,d.jsxs)("div",{className:"order-item-infos-container",children:[(0,d.jsxs)("div",{className:"order-item-section",children:[(0,d.jsx)("span",{className:"order-item-section-icon",children:(0,d.jsx)("i",{className:"far fa-info-square"})}),(0,d.jsxs)("ul",{className:"order-item-list",children:[(0,d.jsxs)("li",{children:["بسته یا خدمات مربوطه: ",(0,d.jsx)("a",{href:u.service.uri,children:u.service.title})]}),(0,d.jsxs)("li",{children:["کد سفارش: ",(0,d.jsx)(o.rU,{to:"/orders/".concat(h.id),children:h.code})]}),(0,d.jsxs)("li",{children:["شیوه ثبت: ",(0,d.jsx)("span",{children:h.method})]})]})]}),(0,d.jsxs)("div",{className:"order-item-section",children:[(0,d.jsx)("span",{className:"order-item-section-icon",children:(0,d.jsx)("i",{className:"far fa-spinner"})}),(0,d.jsxs)("ul",{className:"order-item-list",children:[(0,d.jsxs)("li",{children:["وضعیت: ",(0,d.jsx)("span",{children:u.status_fa})]}),(0,d.jsxs)("li",{children:["توضیحات: ",(0,d.jsx)("span",{children:u.state_info})]})]})]}),(0,d.jsxs)("div",{className:"order-item-section",children:[(0,d.jsx)("span",{className:"order-item-section-icon",children:(0,d.jsx)("i",{className:"far fa-calendar-exclamation"})}),(0,d.jsxs)("ul",{className:"order-item-list",children:[(0,d.jsxs)("li",{children:["موعد تحویل: ",(0,d.jsx)("span",{children:u.due_date?(0,c.B)(u.due_date).format("jYYYY/jM/jD dddd"):""})]}),(0,d.jsxs)("li",{children:["تاریخ اتمام: ",(0,d.jsx)("span",{children:u.finished_at?(0,c.B)(u.finished_at).format("jYYYY/jM/jD dddd"):""})]})]})]}),(0,d.jsxs)("div",{className:"order-item-section",children:[(0,d.jsx)("span",{className:"order-item-section-icon",children:(0,d.jsx)("i",{className:"far fa-comment-alt-medical"})}),(0,d.jsxs)("ul",{className:"order-item-list",children:[(0,d.jsxs)("li",{children:["طرح مربوطه: ",(0,d.jsx)("span",{children:"نیاز به داینامیک سازی"})]}),(0,d.jsxs)("li",{children:["توضیحات پروژه: ",u.description]})]})]})]}),(0,d.jsx)("div",{className:"order-item-progress-container level-".concat(s),children:f&&f.normal.length>0?f.normal.map((function(e,t){return(0,d.jsxs)("div",{className:"order-level-progress",children:[(0,d.jsx)("h4",{className:"order-level-title",children:(0,l.Iu)(e)}),!u.normal&&t+1===s&&(0,d.jsx)("span",{className:"badge badge-warning unnormal-status",children:u.status_fa}),(0,d.jsx)("span",{className:"order-level-circle",children:(0,d.jsx)("i",{className:"far ".concat(e)})})]},t)})):null}),(0,d.jsx)("div",{className:"w-100 table-responsive",children:(0,d.jsxs)("table",{className:"table table-hover",children:[(0,d.jsx)("caption",{children:"تیکت های مرتبط به این سفارش"}),(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"#"}),(0,d.jsx)("th",{children:"شماره تیکت"}),(0,d.jsx)("th",{children:"عنوان تیکت"}),(0,d.jsx)("th",{children:"بخش مربوطه"}),(0,d.jsx)("th",{children:"وضعیت"}),(0,d.jsx)("th",{children:"تاریخ ایجاد"}),(0,d.jsx)("th",{children:"تاریخ اتمام"})]})}),(0,d.jsx)("tbody",{children:this.state.tickets.map((function(t,r){return(0,d.jsxs)("tr",{onClick:function(){return e.onTicketClick(t.id)},children:[(0,d.jsx)("th",{children:r+1}),(0,d.jsx)("td",{children:t.tracking_code}),(0,d.jsx)("td",{children:t.title}),(0,d.jsx)("td",{children:t.department&&t.department.name}),(0,d.jsx)("td",{children:t.closed_at&&"بسته شده"}),(0,d.jsx)("td",{children:(0,c.B)(t.created_at).format()}),(0,d.jsx)("td",{children:(0,c.B)(t.closed_at).format()})]})}))})]})})]})})}}])&&m(t.prototype,r),n&&m(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(i.Component)}}]);